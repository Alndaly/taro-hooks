(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{"221":function(e,t,n){"use strict";var r=n(8),c=n(130),a=n(11),o=(Object(a.h)("saveImageToPhotosAlbum"),Object(a.h)("previewMedia")),i=(Object(a.h)("compressImage"),Object(a.h)("chooseMessageFile")),s=n(16),u=function getImageInfo(e){var t=Object(a.g)(e);if(!t.flag){var n={"errMsg":"getImageInfo:fail ".concat(t.msg)};return console.error(n.errMsg),Promise.reject(n)}var r=function getBase64Image(e){try{var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return null==n||n.drawImage(e,0,0,e.width,e.height),t.toDataURL("image/png")}catch(e){console.error("getImageInfo:get base64 fail",e)}},c=e.src,o=e.success,i=e.fail,u=e.complete,l=new s.b({"name":"getImageInfo","success":o,"fail":i,"complete":u});return new Promise((function(e,t){var n=new Image;n.crossOrigin="",n.onload=function(){l.success({"width":n.naturalWidth,"height":n.naturalHeight,"path":r(n)||c},e)},n.onerror=function(e){l.fail({"errMsg":e.message},t)},n.src=c}))},l=n(3),p=n(12),d=function(){var e=Object(p.a)(Object(l.a)().mark((function _callee(e){var t,n,r,c,o,i,u,p,d,f,b,m,j,O,h,v,g;return Object(l.a)().wrap((function _callee$(l){for(;;)switch(l.prev=l.next){case 0:if(t=function _loadImage(e,t){return new Promise((function(n){var r=document.createElement("taro-swiper-item-core");r.style.cssText="display:flex;align-items:start;justify-content:center;overflow-y:scroll;";var c=new Image;c.style.maxWidth="100%",c.src=e;var a=document.createElement("div");a.style.cssText="display:flex;align-items:center;justify-content:center;max-width:100%;min-height:100%;",a.appendChild(c),r.appendChild(a),n(r),"function"==typeof t&&c.addEventListener("error",(function(e){t({"errMsg":e.message})}))}))},(n=Object(a.g)(e)).flag){l.next=6;break}return r={"errMsg":"previewImage:fail ".concat(n.msg)},console.error(r.errMsg),l.abrupt("return",Promise.reject(r));case 6:return c=e.urls,o=void 0===c?[]:c,i=e.current,u=void 0===i?"":i,p=e.success,d=e.fail,f=e.complete,b=new s.b({"name":"previewImage","success":p,"fail":d,"complete":f}),(m=document.createElement("div")).classList.add("preview-image"),m.style.cssText="position:fixed;top:0;left:0;z-index:1050;width:100%;height:100%;overflow:hidden;outline:0;background-color:#111;",m.addEventListener("click",(function(){m.remove()})),(j=document.createElement("taro-swiper-core")).full=!0,O=[],l.prev=15,l.next=18,Promise.all(o.map((function(e){return t(e,d)})));case 18:O=l.sent,l.next=24;break;case 21:return l.prev=21,l.t0=l.catch(15),l.abrupt("return",b.fail({"errMsg":l.t0}));case 24:for(h=0;h<O.length;h++)v=O[h],j.appendChild(v);return g=o.indexOf(u),j.current=g,m.appendChild(j),document.body.appendChild(m),l.abrupt("return",b.success());case 30:case"end":return l.stop()}}),_callee,null,[[15,21]])})));return function previewImage(t){return e.apply(this,arguments)}}(),f=n(188),b=n(220);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var m={"tempFilePaths":[],"tempFiles":[]};t.a=function useImage(e){var t=r.a.useTaroState(m),n=t[0],a=t[1],s=Object(f.a)(c.a),l=Object(f.a)(i),p=Object(f.a)(b.a),j=Object(f.a)(u),O=Object(f.a)(b.b),h=Object(f.a)(d),v=Object(f.a)(o),g=Object(f.a)(r.a.editImage);return[n,{"choose":function choose(t,n){return void 0===t&&(t={}),n?l(_extends({"count":1},t)):s(_extends({},null!=e?e:{},t)).then((function(e){var t=e.tempFilePaths,n=e.tempFiles;return a({"tempFilePaths":t,"tempFiles":n}),e}))},"compress":function compress(e,t){return void 0===t&&(t=80),p({"src":e,"quality":t})},"get":function get(e){return j({"src":e})},"preview":h,"previewMedia":v,"save":function save(e){return O({"filePath":e})},"edit":function edit(e){return g({"src":e})}}]}},"231":function(e,t,n){var r=n(35),c=n(254);"string"==typeof(c=c.__esModule?c.default:c)&&(c=[[e.i,c,""]]);var a={"insert":"head","singleton":!1};r(c,a);e.exports=c.locals||{}},"253":function(e,t,n){"use strict";n(231)},"254":function(e,t,n){(t=n(29)(!1)).push([e.i,"\n.demo-swiper,\n.demo-swiper-item {\n  height: 8.53333rem;\n}\n.nut-swiper-item {\n  text-align: center;\n}\n",""]),e.exports=t},"345":function(e,t,n){"use strict";n.r(t);var r=n(3),c=n(12),a=n(221),o=n(15),i=n(197),s=n(0),u=n(8),l=n(19),p=Object(s.createTextVNode)("选择图片"),d=Object(s.createTextVNode)("预览照片"),f=Object(s.createTextVNode)("保存照片"),b=Object(s.createTextVNode)("获取图片信息"),m=Object(s.createTextVNode)("获取会话文件(仅小程序)"),j=Object(s.createTextVNode)("编辑图片(仅小程序)"),O=Object(s.createTextVNode)("预览媒体(仅小程序)"),h=Object(s.createTextVNode)("压缩图片"),v=Object(s.defineComponent)({"name":"index","setup":function setup(e){var t=Object(i.a)({"title":"useImage","mask":!0}).show,n=u.a.useTaroState(),v=Object(o.a)(n,2),g=v[0],w=v[1],x=Object(a.a)({"count":15}),k=Object(o.a)(x,2),y=k[0],C=k[1],_=C.choose,I=C.compress,N=C.get,V=C.preview,P=C.previewMedia,F=C.save,T=C.edit,M=function(){var e=Object(c.a)(Object(r.a)().mark((function _callee(){var e,n,c;return Object(r.a)().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,N(null===(e=Object(l.e)(y))||void 0===e||null===(n=e.tempFilePaths)||void 0===n?void 0:n[0]);case 3:c=r.sent,w(c),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t({"title":"获取信息失败","icon":"error"});case 10:case"end":return r.stop()}}),_callee,null,[[0,7]])})));return function handleGetFileInfo(){return e.apply(this,arguments)}}(),B=function(){var e=Object(c.a)(Object(r.a)().mark((function _callee2(){var e,n,c;return Object(r.a)().wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,I(null===(e=Object(l.e)(y))||void 0===e||null===(n=e.tempFilePaths)||void 0===n?void 0:n[0]);case 3:c=r.sent,w(c),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t({"title":"压缩失败","icon":"error"});case 10:case"end":return r.stop()}}),_callee2,null,[[0,7]])})));return function handleCompress(){return e.apply(this,arguments)}}();return function(e,t){var n=Object(s.resolveComponent)("taro-image"),r=Object(s.resolveComponent)("nut-swiper-item"),c=Object(s.resolveComponent)("nut-swiper"),a=Object(s.resolveComponent)("nut-button"),o=Object(s.resolveComponent)("nut-cell"),i=Object(s.resolveComponent)("nut-cell-group"),u=Object(s.resolveComponent)("demo-content");return Object(s.openBlock)(),Object(s.createBlock)(u,null,{"default":Object(s.withCtx)((function(){return[Object(s.createVNode)(c,{"height":"200","class":"demo-swiper gap"},{"default":Object(s.withCtx)((function(){var e;return[(Object(s.openBlock)(!0),Object(s.createElementBlock)(s.Fragment,null,Object(s.renderList)(null===(e=Object(s.unref)(y))||void 0===e?void 0:e.tempFilePaths,(function(e,t){return Object(s.openBlock)(),Object(s.createBlock)(r,{"key":t},{"default":Object(s.withCtx)((function(){return[Object(s.createVNode)(n,{"class":"demo-swiper-item","src":e},null,8,["src"])]})),"_":2},1024)})),128))]})),"_":1}),Object(s.createVNode)(a,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[0]||(t[0]=function(e){return Object(s.unref)(_)()})},{"default":Object(s.withCtx)((function(){return[p]})),"_":1}),Object(s.createVNode)(a,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[1]||(t[1]=function(e){var t;return Object(s.unref)(V)({"urls":null===(t=Object(s.unref)(y))||void 0===t?void 0:t.tempFilePaths})})},{"default":Object(s.withCtx)((function(){return[d]})),"_":1}),Object(s.createVNode)(a,{"class":"gap","shape":"square","type":"primary","block":"","onClick":t[2]||(t[2]=function(e){var t,n;return Object(s.unref)(F)(null===(t=Object(s.unref)(y))||void 0===t||null===(n=t.tempFilePaths)||void 0===n?void 0:n[0])})},{"default":Object(s.withCtx)((function(){return[f]})),"_":1}),Object(s.createVNode)(a,{"class":"gap","shape":"square","type":"primary","block":"","onClick":t[3]||(t[3]=function(e){return M()})},{"default":Object(s.withCtx)((function(){return[b]})),"_":1}),Object(s.createVNode)(a,{"class":"gap","shape":"square","type":"primary","block":"","onClick":t[4]||(t[4]=function(e){return Object(s.unref)(_)({},!0)})},{"default":Object(s.withCtx)((function(){return[m]})),"_":1}),Object(s.createVNode)(a,{"class":"gap","shape":"square","type":"primary","block":"","onClick":t[5]||(t[5]=function(e){var t,n;return Object(s.unref)(T)(null===(t=Object(s.unref)(y))||void 0===t||null===(n=t.tempFilePaths)||void 0===n?void 0:n[0])})},{"default":Object(s.withCtx)((function(){return[j]})),"_":1}),Object(s.createVNode)(a,{"class":"gap","shape":"square","type":"primary","block":"","onClick":t[6]||(t[6]=function(e){var t,n;return Object(s.unref)(P)({"sources":[{"url":null===(t=Object(s.unref)(y))||void 0===t||null===(n=t.tempFilePaths)||void 0===n?void 0:n[0]}]})})},{"default":Object(s.withCtx)((function(){return[O]})),"_":1}),Object(s.createVNode)(a,{"class":"gap","shape":"square","type":"primary","block":"","onClick":t[7]||(t[7]=function(e){return B()})},{"default":Object(s.withCtx)((function(){return[h]})),"_":1}),Object(s.createVNode)(i,{"title":"图片信息"},{"default":Object(s.withCtx)((function(){return[(Object(s.openBlock)(!0),Object(s.createElementBlock)(s.Fragment,null,Object(s.renderList)(Object(s.unref)(g),(function(t,n){return Object(s.openBlock)(),Object(s.createBlock)(o,{"key":n,"title":n,"sub-title":e.$filters.stringify(t)},null,8,["title","sub-title"])})),128))]})),"_":1})]})),"_":1})}}});n(253);const g=v;t.default=g}}]);