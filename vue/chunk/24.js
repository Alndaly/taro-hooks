(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"196":function(e,t,n){"use strict";n.d(t,"a",(function(){return createUseInfoHook}));var r=n(8),o=n(19),c=n(187);function createUseInfoHook(e,t){return function(){return r.a.useTaroRef(function safeExcute(){try{if(!c.c){var n,r=null==(n=e())||null==n.then?void 0:n.then((function(e){return e}),o.l);return Object(c.e)(r,"Promise")&&"then"in r?t:r||e()}return e()}catch(n){return Object(o.m)("[createUseInfoHook]: "+n.message+". "+String(e)),t}}()).current}}},"216":function(e,t,n){"use strict";var r=n(8),o=n(196),c=Object(o.a)(r.a.getEnv,void 0);t.a=c},"230":function(e,t,n){var r=n(35),o=n(252);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var c={"insert":"head","singleton":!1};r(o,c);e.exports=o.locals||{}},"246":function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n(16),o=n(11),c=(Object(o.h)("saveVideoToPhotosAlbum"),Object(o.h)("openVideoEditor")),a=Object(o.h)("getVideoInfo"),i=function createVideoContext(e,t){var n=Object(o.a)(t);return null==n?void 0:n.querySelector("taro-video-core[id=".concat(e,"]"))},u=Object(o.h)("compressVideo"),l=function chooseVideo(e){var t=Object(o.g)(e);if(!t.flag){var n={"errMsg":"chooseVideo:fail ".concat(t.msg)};return console.error(n.errMsg),Promise.reject(n)}var c=e.success,a=e.fail,i=e.complete,u=new r.b({"name":"chooseVideo","success":c,"fail":a,"complete":i}),l={"tempFilePath":"","duration":0,"size":0,"height":0,"width":0},s=document.createElement("input");return s.setAttribute("type","file"),s.setAttribute("multiple","multiple"),s.setAttribute("accept","video/*"),s.setAttribute("style","position: fixed; top: -4000px; left: -3000px; z-index: -300;"),document.body.appendChild(s),new Promise((function(e){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),s.dispatchEvent(t),s.onchange=function(t){var n,r=null===(n=t.target.files)||void 0===n?void 0:n[0],o=new FileReader;o.onload=function(t){var n,r=document.createElement("video"),o=null===(n=t.target)||void 0===n?void 0:n.result;r.preload="metadata",r.src=o,r.onloadedmetadata=function(){return l.tempFilePath=o,l.duration=r.duration,l.size=t.total,l.height=r.videoHeight,l.width=r.videoHeight,u.success(l,e)}},r&&o.readAsDataURL(r)}})).finally((function(){document.body.removeChild(s)}))},s=Object(o.h)("chooseMedia")},"251":function(e,t,n){"use strict";n(230)},"252":function(e,t,n){(t=n(29)(!1)).push([e.i,"\n#demo-video-id {\n  position: relative;\n  left: auto;\n  top: auto;\n  width: 100%;\n  height: 8.53333rem;\n}\n",""]),e.exports=t},"315":function(e,t,n){"use strict";n.r(t);var r=n(3),o=n(12),c=n(197),a=n(8),i=n(246),u=n(188),l=n(220).b,s=["component"];function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var d=function useVideo(e,t){var n=a.a.useTaroState(),r=n[0],o=n[1];a.a.useReady((function(){o(Object(i.d)(e,null==t?void 0:t.component))}));var c=Object(u.a)(i.b),d=Object(u.a)(i.a),f=Object(u.a)(i.f),b=Object(u.a)(l),p=Object(u.a)(i.c),v=Object(u.a)(i.e);return[r,{"choose":function choose(e){void 0===e&&(e={});var n=null!=t?t:{},r=(n.component,function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,r,o={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(n,s));return c(_extends({},e,r))},"chooseMedia":d,"open":function open(e){return f({"filePath":e})},"save":function save(e){return b({"filePath":e})},"compress":p,"get":function get(e){return v({"src":e})}}]},f=n(15),b=n(216),p=n(0),v=n(19),h=Object(p.createTextVNode)("选择视频"),j=Object(p.createTextVNode)("播放视频"),O=Object(p.createTextVNode)("暂停视频"),m=Object(p.createTextVNode)("压缩视频(小程序独有)"),g=Object(p.createTextVNode)("打开视频编辑器(小程序独有)"),x=Object(p.createTextVNode)("保存视频"),k=Object(p.defineComponent)({"name":"index","setup":function setup(e){var t=Object(b.a)(),n=a.a.useTaroState(),i=Object(f.a)(n,2),u=i[0],l=i[1],s=a.a.useTaroState(),k=Object(f.a)(s,2),y=k[0],w=k[1],C=d("demo-video-id",{"camera":"back","sourceType":["camera","album"]}),V=Object(f.a)(C,2),_=V[0],P=V[1],N=P.choose,E=(P.chooseMedia,P.open),T=P.save,F=P.compress,A=P.get,q=Object(c.a)({"title":"initial title","duration":500,"mask":!0}).show,M=function(){var e=Object(o.a)(Object(r.a)().mark((function _callee(){var e,n;return Object(r.a)().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,N();case 3:if(e=r.sent,l(e),t!==a.a.ENV_TYPE.WEAPP){r.next=10;break}return r.next=8,A(e.tempFilePath);case 8:n=r.sent,w(n);case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(0),q({"title":"获取视频或信息失败","icon":"error"});case 15:case"end":return r.stop()}}),_callee,null,[[0,12]])})));return function handleChoose(){return e.apply(this,arguments)}}(),B=function handleVideoAction(e){var t,n;console.log(_),null===(t=Object(v.e)(_))||void 0===t||null===(n=t[e])||void 0===n||n.call(t)},z=function(){var e=Object(o.a)(Object(r.a)().mark((function _callee2(){var e,t;return Object(r.a)().wrap((function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,F({"src":null==u?void 0:u.tempFilePath});case 3:e=n.sent,t=e.size,q({"title":"压缩: ".concat(t,"/").concat(null==u?void 0:u.size)}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),q({"title":"压缩失败","icon":"error"});case 11:case"end":return n.stop()}}),_callee2,null,[[0,8]])})));return function handleCompress(){return e.apply(this,arguments)}}();return function(e,t){var n=Object(p.resolveComponent)("taro-video"),r=Object(p.resolveComponent)("nut-button"),o=Object(p.resolveComponent)("nut-cell"),c=Object(p.resolveComponent)("nut-cell-group"),a=Object(p.resolveComponent)("demo-content");return Object(p.openBlock)(),Object(p.createBlock)(a,null,{"default":Object(p.withCtx)((function(){var a;return[Object(p.createVNode)(n,{"id":"demo-video-id","src":null===(a=Object(p.unref)(u))||void 0===a?void 0:a.tempFilePath},null,8,["src"]),Object(p.createVNode)(r,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[0]||(t[0]=function(e){return M()})},{"default":Object(p.withCtx)((function(){return[h]})),"_":1}),Object(p.createVNode)(r,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[1]||(t[1]=function(e){return B("play")})},{"default":Object(p.withCtx)((function(){return[j]})),"_":1}),Object(p.createVNode)(r,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[2]||(t[2]=function(e){return B("pause")})},{"default":Object(p.withCtx)((function(){return[O]})),"_":1}),Object(p.createVNode)(r,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[3]||(t[3]=function(e){return z()})},{"default":Object(p.withCtx)((function(){return[m]})),"_":1}),Object(p.createVNode)(r,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[4]||(t[4]=function(e){var t;return Object(p.unref)(E)(null===(t=Object(p.unref)(u))||void 0===t?void 0:t.tempFilePath)})},{"default":Object(p.withCtx)((function(){return[g]})),"_":1}),Object(p.createVNode)(r,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[5]||(t[5]=function(e){var t;return Object(p.unref)(T)(null===(t=Object(p.unref)(u))||void 0===t?void 0:t.tempFilePath)})},{"default":Object(p.withCtx)((function(){return[x]})),"_":1}),Object(p.createVNode)(c,{"title":"视频信息"},{"default":Object(p.withCtx)((function(){var t;return[(Object(p.openBlock)(!0),Object(p.createElementBlock)(p.Fragment,null,Object(p.renderList)(null!==(t=Object(p.unref)(y))&&void 0!==t?t:{},(function(t,n){return Object(p.openBlock)(),Object(p.createBlock)(o,{"key":n,"title":n,"sub-title":e.$filters.stringify(t)},null,8,["title","sub-title"])})),128))]})),"_":1})]})),"_":1})}}});n(251);const y=k;t.default=y}}]);