(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{"221":function(e,t,r){"use strict";var n=r(8),a=r(130),c=r(11),o=(Object(c.h)("saveImageToPhotosAlbum"),Object(c.h)("previewMedia")),i=(Object(c.h)("compressImage"),Object(c.h)("chooseMessageFile")),s=r(16),u=function getImageInfo(e){var t=Object(c.g)(e);if(!t.flag){var r={"errMsg":"getImageInfo:fail ".concat(t.msg)};return console.error(r.errMsg),Promise.reject(r)}var n=function getBase64Image(e){try{var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return null==r||r.drawImage(e,0,0,e.width,e.height),t.toDataURL("image/png")}catch(e){console.error("getImageInfo:get base64 fail",e)}},a=e.src,o=e.success,i=e.fail,u=e.complete,l=new s.b({"name":"getImageInfo","success":o,"fail":i,"complete":u});return new Promise((function(e,t){var r=new Image;r.crossOrigin="",r.onload=function(){l.success({"width":r.naturalWidth,"height":r.naturalHeight,"path":n(r)||a},e)},r.onerror=function(e){l.fail({"errMsg":e.message},t)},r.src=a}))},l=r(3),p=r(12),f=function(){var e=Object(p.a)(Object(l.a)().mark((function _callee(e){var t,r,n,a,o,i,u,p,f,m,d,h,b,v,g,j,O;return Object(l.a)().wrap((function _callee$(l){for(;;)switch(l.prev=l.next){case 0:if(t=function _loadImage(e,t){return new Promise((function(r){var n=document.createElement("taro-swiper-item-core");n.style.cssText="display:flex;align-items:start;justify-content:center;overflow-y:scroll;";var a=new Image;a.style.maxWidth="100%",a.src=e;var c=document.createElement("div");c.style.cssText="display:flex;align-items:center;justify-content:center;max-width:100%;min-height:100%;",c.appendChild(a),n.appendChild(c),r(n),"function"==typeof t&&a.addEventListener("error",(function(e){t({"errMsg":e.message})}))}))},(r=Object(c.g)(e)).flag){l.next=6;break}return n={"errMsg":"previewImage:fail ".concat(r.msg)},console.error(n.errMsg),l.abrupt("return",Promise.reject(n));case 6:return a=e.urls,o=void 0===a?[]:a,i=e.current,u=void 0===i?"":i,p=e.success,f=e.fail,m=e.complete,d=new s.b({"name":"previewImage","success":p,"fail":f,"complete":m}),(h=document.createElement("div")).classList.add("preview-image"),h.style.cssText="position:fixed;top:0;left:0;z-index:1050;width:100%;height:100%;overflow:hidden;outline:0;background-color:#111;",h.addEventListener("click",(function(){h.remove()})),(b=document.createElement("taro-swiper-core")).full=!0,v=[],l.prev=15,l.next=18,Promise.all(o.map((function(e){return t(e,f)})));case 18:v=l.sent,l.next=24;break;case 21:return l.prev=21,l.t0=l.catch(15),l.abrupt("return",d.fail({"errMsg":l.t0}));case 24:for(g=0;g<v.length;g++)j=v[g],b.appendChild(j);return O=o.indexOf(u),b.current=O,h.appendChild(b),document.body.appendChild(h),l.abrupt("return",d.success());case 30:case"end":return l.stop()}}),_callee,null,[[15,21]])})));return function previewImage(t){return e.apply(this,arguments)}}(),m=r(188),d=r(220);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var h={"tempFilePaths":[],"tempFiles":[]};t.a=function useImage(e){var t=n.a.useTaroState(h),r=t[0],c=t[1],s=Object(m.a)(a.a),l=Object(m.a)(i),p=Object(m.a)(d.a),b=Object(m.a)(u),v=Object(m.a)(d.b),g=Object(m.a)(f),j=Object(m.a)(o),O=Object(m.a)(n.a.editImage);return[r,{"choose":function choose(t,r){return void 0===t&&(t={}),r?l(_extends({"count":1},t)):s(_extends({},null!=e?e:{},t)).then((function(e){var t=e.tempFilePaths,r=e.tempFiles;return c({"tempFilePaths":t,"tempFiles":r}),e}))},"compress":function compress(e,t){return void 0===t&&(t=80),p({"src":e,"quality":t})},"get":function get(e){return b({"src":e})},"preview":g,"previewMedia":j,"save":function save(e){return v({"filePath":e})},"edit":function edit(e){return O({"src":e})}}]}},"233":function(e,t,r){var n=r(35),a=r(258);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var c={"insert":"head","singleton":!1};n(a,c);e.exports=a.locals||{}},"257":function(e,t,r){"use strict";r(233)},"258":function(e,t,r){(t=r(29)(!1)).push([e.i,"\n#demo-camera-id {\n  position: relative;\n  left: auto;\n  top: auto;\n  width: 100%;\n  height: 8.53333rem;\n  margin-bottom: 0.85333rem;\n}\n",""]),e.exports=t},"316":function(e,t,r){"use strict";r.r(t);var n=r(3),a=r(12),c=r(197),o=r(221),i=r(8),s=r(11),u=Object(s.h)("createCameraContext"),l=r(188);var p=function useCamera(){var e=i.a.useTaroRef(u()),t=Object(l.a)(e.current.setZoom),r=Object(l.a)(e.current.startRecord),n=Object(l.a)(e.current.stopRecord),a=Object(l.a)(e.current.takePhoto);return[e.current,{"zoom":function zoom(e){return t({"zoom":e})},"start":r,"stop":function stop(e){return n({"compressed":e})},"take":a,"listener":function listener(t){return e.current.onCameraFrame(t)}}]},f=r(15),m=r(0),d=Object(m.createTextVNode)("开始录制"),h=Object(m.createTextVNode)("停止录制"),b=Object(m.createTextVNode)("拍照"),v=Object(m.defineComponent)({"name":"index","setup":function setup(e){var t=p(),r=Object(f.a)(t,2),i=(r[0],r[1]),s=(i.zoom,i.start),u=i.stop,l=i.take,v=Object(o.a)(),g=Object(f.a)(v,2)[1],j=g.preview,O=g.previewMedia,w=Object(c.a)({"title":"useCamera","duration":500,"mask":!0}).show,x=function(){var e=Object(a.a)(Object(n.a)().mark((function _callee(){return Object(n.a)().wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s();case 3:w({"title":"开启录制成功"}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),w({"title":"开启录制失败","icon":"error"});case 9:case"end":return e.stop()}}),_callee,null,[[0,6]])})));return function handleStart(){return e.apply(this,arguments)}}(),y=function(){var e=Object(a.a)(Object(n.a)().mark((function _callee2(){var e;return Object(n.a)().wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u();case 3:e=t.sent,O({"sources":[{"url":e.tempVideoPath}]}),w({"title":"关闭录制成功"}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),w({"title":"关闭录制失败","icon":"error"});case 11:case"end":return t.stop()}}),_callee2,null,[[0,8]])})));return function handleStop(){return e.apply(this,arguments)}}(),k=function(){var e=Object(a.a)(Object(n.a)().mark((function _callee3(){var e,t;return Object(n.a)().wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,l();case 3:e=r.sent,t=e.tempImagePath,j({"urls":[t]}),w({"title":"拍摄成功"}),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),w({"title":"拍摄失败","icon":"error"});case 12:case"end":return r.stop()}}),_callee3,null,[[0,9]])})));return function handleTake(){return e.apply(this,arguments)}}();return function(e,t){var r=Object(m.resolveComponent)("taro-camera"),n=Object(m.resolveComponent)("nut-button"),a=Object(m.resolveComponent)("demo-content");return Object(m.openBlock)(),Object(m.createBlock)(a,null,{"default":Object(m.withCtx)((function(){return[Object(m.createVNode)(r,{"id":"demo-camera-id"}),Object(m.createVNode)(n,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[0]||(t[0]=function(e){return x()})},{"default":Object(m.withCtx)((function(){return[d]})),"_":1}),Object(m.createVNode)(n,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[1]||(t[1]=function(e){return y()})},{"default":Object(m.withCtx)((function(){return[h]})),"_":1}),Object(m.createVNode)(n,{"shape":"square","type":"primary","class":"gap","block":"","onClick":t[2]||(t[2]=function(e){return k()})},{"default":Object(m.withCtx)((function(){return[b]})),"_":1})]})),"_":1})}}});r(257);const g=v;t.default=g}}]);