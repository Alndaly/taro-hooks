(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{"187":function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return generateGeneralFail})),n.d(t,"a",(function(){return combineOptions})),n.d(t,"d",(function(){return stringfiyUrl}));var r=n(19),o=n(189);var a=!0,c=function typeOf(e,t){return[t].flat().some((function(t){return Object.prototype.toString.call(e)==="[object "+t+"]"}))};function generateGeneralFail(e,t){var n="[API "+e+"] "+(t=t||"调用失败");return a||Object(r.m)(n),{"errMsg":n}}function combineOptions(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),Object.assign({},e,t)}function stringfiyUrl(e,t){var n=e;if(t&&Object(r.n)(t,"Object")){var a=n.includes("?");n+=(a?"&":"?")+Object(o.stringify)(t)}return n}},"189":function(e,t,n){"use strict";t.decode=t.parse=n(190),t.encode=t.stringify=n(191)},"190":function(e,t,n){"use strict";function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var c=/\+/g;e=e.split(t);var i=1e3;o&&"number"==typeof o.maxKeys&&(i=o.maxKeys);var u=e.length;i>0&&u>i&&(u=i);for(var s=0;s<u;++s){var l,d,f,p,b=e[s].replace(c,"%20"),v=b.indexOf(n);v>=0?(l=b.substr(0,v),d=b.substr(v+1)):(l=b,d=""),f=decodeURIComponent(l),p=decodeURIComponent(d),hasOwnProperty(a,f)?r(a[f])?a[f].push(p):a[f]=[a[f],p]:a[f]=p}return a};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},"191":function(e,t,n){"use strict";var r=n(22).default,o=function stringifyPrimitive(e){switch(r(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,i){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"===r(e)?map(c(e),(function(r){var c=encodeURIComponent(o(r))+n;return a(e[r])?map(e[r],(function(e){return c+encodeURIComponent(o(e))})).join(t):c+encodeURIComponent(o(e[r]))})).join(t):i?encodeURIComponent(o(i))+n+encodeURIComponent(o(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function map(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var c=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},"246":function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var r=n(16),o=n(11),a=(Object(o.h)("saveVideoToPhotosAlbum"),Object(o.h)("openVideoEditor")),c=Object(o.h)("getVideoInfo"),i=function createVideoContext(e,t){var n=Object(o.a)(t);return null==n?void 0:n.querySelector("taro-video-core[id=".concat(e,"]"))},u=Object(o.h)("compressVideo"),s=function chooseVideo(e){var t=Object(o.g)(e);if(!t.flag){var n={"errMsg":"chooseVideo:fail ".concat(t.msg)};return console.error(n.errMsg),Promise.reject(n)}var a=e.success,c=e.fail,i=e.complete,u=new r.b({"name":"chooseVideo","success":a,"fail":c,"complete":i}),s={"tempFilePath":"","duration":0,"size":0,"height":0,"width":0},l=document.createElement("input");return l.setAttribute("type","file"),l.setAttribute("multiple","multiple"),l.setAttribute("accept","video/*"),l.setAttribute("style","position: fixed; top: -4000px; left: -3000px; z-index: -300;"),document.body.appendChild(l),new Promise((function(e){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),l.dispatchEvent(t),l.onchange=function(t){var n,r=null===(n=t.target.files)||void 0===n?void 0:n[0],o=new FileReader;o.onload=function(t){var n,r=document.createElement("video"),o=null===(n=t.target)||void 0===n?void 0:n.result;r.preload="metadata",r.src=o,r.onloadedmetadata=function(){return s.tempFilePath=o,s.duration=r.duration,s.size=t.total,s.height=r.videoHeight,s.width=r.videoHeight,u.success(s,e)}},r&&o.readAsDataURL(r)}})).finally((function(){document.body.removeChild(l)}))},l=Object(o.h)("chooseMedia")},"299":function(e,t,n){"use strict";n.r(t);var r=n(3),o=n(12),a=n(185),c=n(16),i=n(39),u=function downloadFile(e){var t,n=e.url,r=e.header,o=e.success,a=e.fail,u=e.complete,s=new Promise((function(e,s){t=function createDownloadTask(e){var t,n=e.url,r=e.header,o=e.success,a=e.error,u="downloadFile",s=new XMLHttpRequest,l={"headersReceived":new c.a,"progressUpdate":new c.a};s.open("GET",n,!0),s.responseType="blob",Object(i.d)(s,r),s.onprogress=function(e){var t=e.loaded,n=e.total;l.progressUpdate.trigger({"progress":Math.round(t/n*100),"totalBytesWritten":t,"totalBytesExpectedToWrite":n})},s.onreadystatechange=function(){s.readyState===i.b.HEADERS_RECEIVED&&l.headersReceived.trigger({"header":s.getAllResponseHeaders()})},s.onload=function(){var e=s.response,t=s.status;o({"errMsg":"".concat(u,":ok"),"statusCode":t,"tempFilePath":window.URL.createObjectURL(e)})},s.onabort=function(){clearTimeout(t),a({"errMsg":"".concat(u,":fail abort")})},s.onerror=function(e){a({"errMsg":"".concat(u,":fail ").concat(e.message)})};var d=function abort(){s.abort()};!function send(){s.send(),t=setTimeout((function(){s.onabort=null,s.onload=null,s.onprogress=null,s.onreadystatechange=null,s.onerror=null,d(),a({"errMsg":"".concat(u,":fail timeout")})}),i.a)}();var f=l.headersReceived.add,p=l.headersReceived.remove,b=l.progressUpdate.add,v=l.progressUpdate.remove;return{"abort":d,"onHeadersReceived":f,"offHeadersReceived":p,"onProgressUpdate":b,"offProgressUpdate":v}}({"url":n,"header":r,"success":function success(t){o&&o(t),u&&u(t),e(t)},"error":function error(e){a&&a(e),u&&u(e),s(e)}})}));return s.headersReceive=t.onHeadersReceived,s.progress=t.onProgressUpdate,s.abort=t.abort,s},s=n(187),l=["progress","headersReceive","afterSend"],d=["afterSend"];function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var f=function useFile(){return{"upload":function upload(e){return new Promise((function(t,n){try{var r=filterOptions(e),o=r[0],c=r[1];autoListenWithTask(Object(a.a)(_extends({},o||{},{"success":t,"fail":n})),c)}catch(e){n(Object(s.b)("uploadFile",e.message))}}))},"download":function download(e){return new Promise((function(t,n){try{var r=filterOptions(e),o=r[0],a=r[1];autoListenWithTask(u(_extends({},o||{},{"success":t,"fail":n})),a)}catch(e){n(Object(s.b)("downloadFile",e.message))}}))}}};function filterOptions(e){var t=e.progress,n=e.headersReceive,r=e.afterSend;return[_objectWithoutPropertiesLoose(e,l),{"progress":t,"headersReceive":n,"afterSend":r}]}function autoListenWithTask(e,t){var n=t.afterSend,r=_objectWithoutPropertiesLoose(t,d);null==n||n(e),Object.entries(r).filter((function(e){return e[1]})).forEach((function(t){var n,r=t[0],o=t[1];return null==e||null==(n=e[r])?void 0:n.call(e,o)}))}var p=n(15),b=n(0),v=n(8),h=n(333),O=n(246),g=n(19),j=Object(b.createTextVNode)("点击"),m=Object(b.createTextVNode)("点击");const y=Object(b.defineComponent)({"name":"index","setup":function setup(e){var t=v.a.useTaroState(!1),n=Object(p.a)(t,2),a=n[0],c=n[1],i=v.a.useTaroState(0),u=Object(p.a)(i,2),s=u[0],l=u[1],d=v.a.useTaroState("https://storage.360buyimg.com/nutui/video/video_NutUI.mp4"),y=Object(p.a)(d,2),w=y[0],x=y[1],R=v.a.useTaroState(0),C=Object(p.a)(R,2),P=C[0],k=C[1],U=f(),V=U.download,_=U.upload,S=function onProgress(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.progress,n=void 0===t?0:t,r=e.totalBytesSent,o=void 0===r?0:r,a=e.totalBytesExpectedToSend,c=void 0===a?0:a,i=arguments.length>1?arguments[1]:void 0;i(n),Object(h.h)({"title":"".concat(n,"%: ").concat(o," / ").concat(c),"icon":"loading","mask":!0})},T=function onHeadersReceived(e){Object(g.l)(e),Object(h.h)({"title":"onHeadersReceived trigger","icon":"none","mask":!0})},E=function(){var e=Object(o.a)(Object(r.a)().mark((function _callee(){var e,t,n;return Object(r.a)().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(null!==(e=Object(g.e)(w))&&void 0!==e&&e.length){r.next=2;break}return r.abrupt("return");case 2:return t={"progress":function downloadUpdate(e){return S(e,k)},"headersReceive":T,"url":Object(g.e)(w)},c(!0),k(0),r.prev=6,r.next=9,V(t);case 9:n=r.sent,Object(h.g)({"title":"下载成功","content":null==n?void 0:n.tempFilePath,"showCancel":!1}),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(6),Object(g.m)(r.t0.message);case 16:c(!1);case 17:case"end":return r.stop()}}),_callee,null,[[6,13]])})));return function handleDownload(){return e.apply(this,arguments)}}(),A=function(){var e=Object(o.a)(Object(r.a)().mark((function _callee2(){var e,t,n;return Object(r.a)().wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(O.b)({});case 3:if(null==(e=r.sent)||!e.tempFilePath){r.next=13;break}return l(0),c(!0),t={"progress":function uploadUpdate(e){return S(e,l)},"headersReceive":T,"filePath":e.tempFilePath},r.next=11,_(t);case 11:n=r.sent,Object(h.g)({"title":"上传成功","content":null==n?void 0:n.data,"showCancel":!1});case 13:r.next=18;break;case 15:r.prev=15,r.t0=r.catch(0),Object(g.m)(r.t0.message);case 18:c(!1);case 19:case"end":return r.stop()}}),_callee2,null,[[0,15]])})));return function handleUpload(){return e.apply(this,arguments)}}();return function(e,t){var n=Object(b.resolveComponent)("nut-button"),r=Object(b.resolveComponent)("nut-cell"),o=Object(b.resolveComponent)("nut-progress"),c=Object(b.resolveComponent)("nut-input"),i=Object(b.resolveComponent)("demo-content");return Object(b.openBlock)(),Object(b.createBlock)(i,null,{"default":Object(b.withCtx)((function(){return[Object(b.createVNode)(r,{"title":"上传"},{"link":Object(b.withCtx)((function(){return[Object(b.createVNode)(n,{"onClick":t[0]||(t[0]=function(e){return A()})},{"default":Object(b.withCtx)((function(){return[j]})),"_":1})]})),"_":1}),Object(b.createVNode)(o,{"percentage":Object(b.unref)(s)},null,8,["percentage"]),Object(b.createVNode)(c,{"label":"地址","placeholder":"请输入下载地址","modelValue":Object(b.unref)(w),"onUpdate:modelValue":[t[1]||(t[1]=function(e){return Object(b.isRef)(w)?w.value=e:null}),t[2]||(t[2]=function(e){return Object(b.unref)(x)(e)})]},null,8,["modelValue"]),Object(b.createVNode)(r,{"title":"下载"},{"link":Object(b.withCtx)((function(){return[Object(b.createVNode)(n,{"loading":Object(b.unref)(a),"onClick":t[3]||(t[3]=function(e){return E()})},{"default":Object(b.withCtx)((function(){return[m]})),"_":1},8,["loading"])]})),"_":1}),Object(b.createVNode)(o,{"percentage":Object(b.unref)(P)},null,8,["percentage"])]})),"_":1})}}});t.default=y}}]);