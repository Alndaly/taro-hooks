{"code":"import { isFunction, isArray } from '@tarojs/shared';\r\nimport { PageContext } from './react';\r\nimport React from 'react';\r\nimport { getPageInstance, injectPageInstance } from './common';\r\nimport { Current } from '../current';\r\nimport { HOOKS_APP_ID } from '../constants';\r\nconst taroHooks = (lifecycle) => {\r\n    return (fn) => {\r\n        const id = React.useContext(PageContext) || HOOKS_APP_ID;\r\n        // hold fn ref and keep up to date\r\n        const fnRef = React.useRef(fn);\r\n        if (fnRef.current !== fn)\r\n            fnRef.current = fn;\r\n        React.useLayoutEffect(() => {\r\n            let inst = getPageInstance(id);\r\n            let first = false;\r\n            if (inst == null) {\r\n                first = true;\r\n                inst = Object.create(null);\r\n            }\r\n            inst = inst;\r\n            // callback is immutable but inner function is up to date\r\n            const callback = (...args) => fnRef.current(...args);\r\n            if (isFunction(inst[lifecycle])) {\r\n                inst[lifecycle] = [inst[lifecycle], callback];\r\n            }\r\n            else {\r\n                inst[lifecycle] = [\r\n                    ...(inst[lifecycle] || []),\r\n                    callback,\r\n                ];\r\n            }\r\n            if (first) {\r\n                injectPageInstance(inst, id);\r\n            }\r\n            return () => {\r\n                const inst = getPageInstance(id);\r\n                const list = inst[lifecycle];\r\n                if (list === callback) {\r\n                    inst[lifecycle] = undefined;\r\n                }\r\n                else if (isArray(list)) {\r\n                    inst[lifecycle] = list.filter((item) => item !== callback);\r\n                }\r\n            };\r\n        }, []);\r\n    };\r\n};\r\nexport const useDidShow = taroHooks('componentDidShow');\r\nexport const useDidHide = taroHooks('componentDidHide');\r\nexport const usePullDownRefresh = taroHooks('onPullDownRefresh');\r\nexport const useReachBottom = taroHooks('onReachBottom');\r\nexport const usePageScroll = taroHooks('onPageScroll');\r\nexport const useResize = taroHooks('onResize');\r\nexport const useShareAppMessage = taroHooks('onShareAppMessage');\r\nexport const useTabItemTap = taroHooks('onTabItemTap');\r\nexport const useTitleClick = taroHooks('onTitleClick');\r\nexport const useOptionMenuClick = taroHooks('onOptionMenuClick');\r\nexport const usePullIntercept = taroHooks('onPullIntercept');\r\nexport const useShareTimeline = taroHooks('onShareTimeline');\r\nexport const useAddToFavorites = taroHooks('onAddToFavorites');\r\nexport const useReady = taroHooks('onReady');\r\nexport const useRouter = (dynamic = false) => {\r\n    return dynamic ? Current.router : React.useMemo(() => Current.router, []);\r\n};\r\nexport const useScope = () => undefined;\r\n//# sourceMappingURL=hooks.js.map","references":["/Users/inoccent/github/taro-hooks/node_modules/@tarojs/shared/dist/index.d.ts","/Users/inoccent/github/taro-hooks/packages/taro-runtime/src/dsl/react.ts","/Users/inoccent/github/taro-hooks/node_modules/@types/react/index.d.ts","/Users/inoccent/github/taro-hooks/packages/taro-runtime/src/dsl/common.ts","/Users/inoccent/github/taro-hooks/packages/taro-runtime/src/dsl/instance.ts","/Users/inoccent/github/taro-hooks/packages/taro-runtime/src/current.ts","/Users/inoccent/github/taro-hooks/packages/taro-runtime/src/constants/index.ts","/Users/inoccent/github/taro-hooks/packages/taro-runtime/src/interface/index.ts"],"map":"{\"version\":3,\"file\":\"hooks.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/dsl/hooks.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/inoccent/github/taro-hooks/packages/taro-runtime/node_modules/.cache/rollup-plugin-typescript2/placeholder/dsl/hooks.d.ts","writeByteOrderMark":false,"text":"import type { Func } from '../interface';\r\nexport declare const useDidShow: (fn: Func) => void;\r\nexport declare const useDidHide: (fn: Func) => void;\r\nexport declare const usePullDownRefresh: (fn: Func) => void;\r\nexport declare const useReachBottom: (fn: Func) => void;\r\nexport declare const usePageScroll: (fn: Func) => void;\r\nexport declare const useResize: (fn: Func) => void;\r\nexport declare const useShareAppMessage: (fn: Func) => void;\r\nexport declare const useTabItemTap: (fn: Func) => void;\r\nexport declare const useTitleClick: (fn: Func) => void;\r\nexport declare const useOptionMenuClick: (fn: Func) => void;\r\nexport declare const usePullIntercept: (fn: Func) => void;\r\nexport declare const useShareTimeline: (fn: Func) => void;\r\nexport declare const useAddToFavorites: (fn: Func) => void;\r\nexport declare const useReady: (fn: Func) => void;\r\nexport declare const useRouter: (dynamic?: boolean) => import(\"../current\").Router | null;\r\nexport declare const useScope: () => undefined;\r\n"}}
